<html>

<head>
  <!--Load the AJAX API-->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    .Grade-Charts {
      text-align: center;
      font-family: Arial, Helvetica, sans-serif;

    }
  </style>
</head>

<body>
  <!--Div that will hold the pie chart-->
  <div class="Grade-Charts">
    <h1>Students Grades</h1>
    <div id="col_chart_html_tooltip"></div>
    <button id="AExam">Exam A </button>
    <button id="BExam">Exam B </button>
    <button id="CExam">Exam C </button>
    <button id="AllExams"> All Exams </button>
  </div>



  <script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);
    let AExam = [];
    let BExam = [];
    let CExam = [];
    let AllExams = [];
    let arrayLebgth = 0;

    function drawChart() {
      var dataTable = new google.visualization.DataTable();
      dataTable.addColumn('string', 'Grade');
      dataTable.addColumn('number', 'Sales');
      // A column for custom tooltip content
      dataTable.addColumn({ type: 'string', role: 'tooltip' });
      axios.get('converted.json')
        .then(res => {
          for (let i = 0; i < res.data.length; i++) {
            let Grade = Number(res.data[i].Grade);
            console.log(res.data[i].Name);
            dataTable.addRows(
              [
                [res.data[i].Name, Grade, + '-' + res.data[i].Exam]
              ]);
          }
          // filter the response data into three array`s by each exam. 
          AExam = res.data.filter(data => {

            if (data.Exam === 'A') {
              return data
            }
          })
          BExam = res.data.filter(data => {

            if (data.Exam === 'B') {
              return data
            }
          })
          CExam = res.data.filter(data => {

            if (data.Exam === 'C') {
              return data
            }
          })

          console.log(AExam, "AExam");
          console.log(BExam, "BExam");
          console.log(CExam, "CExam");

          var options = {
            tooltip: { isHtml: true },
            legend: 'none'
          };
          var chart = new google.visualization.ColumnChart(document.getElementById('col_chart_html_tooltip'));
          chart.draw(dataTable, options);


          arrayLebgth = res.data.length;
          AllExams = res.data
        })




      document.getElementById("AExam").addEventListener("click", function () { displayDate(AExam) });
      document.getElementById("BExam").addEventListener("click", function () { displayDate(BExam) });
      document.getElementById("CExam").addEventListener("click", function () { displayDate(CExam) });
      document.getElementById("AllExams").addEventListener("click", function () { displayDate(AllExams) });

      function displayDate(ExamtypeArray) {
        // dataTable.hg =[];
        console.log(arrayLebgth, 'arrayLebgth');

        dataTable.removeRows(0, arrayLebgth);
        // console.log(dataTable);

        for (let i = 0; i < ExamtypeArray.length; i++) {
          console.log(ExamtypeArray[i].Exam, "Exam");

          let Grade = Number(ExamtypeArray[i].Grade);
          dataTable.addRows(
            [
              [ExamtypeArray[i].Name, Grade, ExamtypeArray[i].Name + '-' + ExamtypeArray[i].Exam]
            ]);

        }

        console.log(ExamtypeArray);



        var options = {
          tooltip: { isHtml: true },
          legend: 'none'
        };

        
        function selectHandler(e) {
          alert('A table row was selected');
        }
        
        var chart = new google.visualization.ColumnChart(document.getElementById('col_chart_html_tooltip'));
        google.visualization.events.addListener(dataTable, 'select', selectHandler);
        chart.draw(dataTable, options);
      }
    }





  </script>
  </head>